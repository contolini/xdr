(function(){if(!window.DOMParser&&window.ActiveXObject){var e=function(){};e.prototype.baseURI=null,e.prototype.parseFromString=function(e,t){var n=new ActiveXObject("Microsoft.XMLDOM");return n.async=!0,n.validateOnParse=!1,n.loadXML(e),n},window.DOMParser=e}var t=function(e,t,n){var r=document.createElement(e);for(var i in t)r.setAttribute(i,t[i]);return n&&r.appendChild(document.createTextNode(n)),r},n=function(){var e=0,t=!1,n,r;return n={5.5:5.5,5.6:6,5.7:7,5.8:8,9:9,10:10},r=(new Function("/*@cc_on return @_jscript_version; @*/"))(),r!==undefined&&(t=!0,e=n[r]),{version:e,browser:t}}(),r=function(e){var t={},n,r,i,s;e=e||"",e=e.replace("\r",""),e=e.split("\n");for(n=0;n<e.length;n++)r=e[n].indexOf(":"),i=e[n].substr(0,r),s=e[n].substr(r+1),i&&s&&(i=i.replace(/^\s+/,"").replace(/\s+$/,""),s=s.replace(/^\s+/,"").replace(/\s+$/,""),t[i.toLowerCase()]=s);return t},i=function(e,t){if(!t||typeof t!="object")return e;var n=e,r=[];for(var i in t)r.push(encodeURIComponent(i)+"="+encodeURIComponent(t[i]));var s=r.join("&");return n+=n.indexOf("?")==-1?"?":"&",n+=s,n},s={text:{mime:"text/plain",encode:function(e){return e},decode:function(e){return e}},json:{mime:"application/json",encode:function(e){return JSON.stringify(e)},decode:function(e){return JSON.parse(e)}},xml:{mime:"application/xml",encode:function(e){return e},decode:function(e){var t=new DOMParser;return t.parseFromString(e,"application/xml")}}},o=function(e,t){var n=e;if(s[t]){var r=s[t].decode;n=r(n)}return n},a=!("XDomainRequest"in window)||n.browser&&n.version==10,f=function(){return a?window.XMLHttpRequest?new XMLHttpRequest:null:new XDomainRequest},l=function(e,t){this.url=e,this.options=t};l.counter=-1,l.prototype.send=function(e){var n=this,r=this.options.encoder(e),i="__jsonp_"+ ++l.counter,s=t("script",{src:u});window[i]=function(e){if(typeof n.options.success=="function"){var t={status:200,xhr:n,headers:null};t.data=e,n.options.success(t)}};var o=document.getElementsByTagName("head")[0]||document.documentElement,a=!1,f=function(){window[i]=null,delete window[i],o&&s.parentNode&&o.removeChild(s)};s.onload=s.onreadystatechange=function(){!a&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")&&(a=!0,s.onload=s.onreadystatechange=null,f())},o.insertBefore(s,o.firstChild)},l.prototype.abort=function(){};var c=function(e){var t,u,h=!1;if(typeof e=="object"&&"JSON"in window){var p=e.type||"text";p=="jsonp"&&(h=!0,p="json");if(p in s){if(!!h||!(n.browser&&n.version<8)&&("XMLHttpRequest"in window||"XDomainRequest"in window)){var d=i(e.url||"",e.params),v=e.method||c.defaults.method,m=e.headers||{},g=typeof e.async=="boolean"?e.async:c.defaults.async;e.credentials=e.credentials||{};if(e.data){var y=s[p].encode;e.data=y(e.data)}var b=function(t){var n=""+(t.status||0);/^2/.test(n)?typeof e.success=="function"&&e.success(t):typeof e.error=="function"&&e.error(t)};if(h)t=new l(d,e),console.log("run as jsonp..."),t.send(data);else{t=f();if(!a)t.open(v,d),t.onload=function(){var e={status:this.status||200,xhr:this,headers:null};e.data=o(this.responseText,p),b(e)},t.onerror=function(){var e={status:this.status||500,xhr:this,headers:null};b(e)},t.ontimeout=t.onprogress=function(){};else{if(e.fields)for(u in e.fields)t[u]=e.fields[u];t.open(v,d,g,e.credentials.username,e.credentials.password),e.mime&&typeof t.overrideMimeType=="function"&&t.overrideMimeType(e.mime);for(u in c.defaults.headers)t.setRequestHeader(u,c.defaults.headers[u]);for(u in m)t.setRequestHeader(u,m[u]);t.onreadystatechange=function(){if(this.readyState==4){var e={status:this.status,xhr:this};e.headers=r(this.getAllResponseHeaders()),e.data=o(this.responseText,p),b(e)}}}t.timeout=e.timeout||c.defaults.timeout,n?setTimeout(function(){t.send(e.data)},e.delay||c.defaults.delay):t.send(e.data)}return{xhr:t,abort:t.abort,cors:a,ie:n,url:d}}return!1}return!1}return!1};c.ie=n,c.converters=s,c.defaults={method:"GET",timeout:1e4,delay:0,async:!0,headers:{"X-Requested-With":"XMLHttpRequest"}},typeof module=="object"&&typeof module.exports=="object"?module.exports=c:typeof define=="function"&&define.amd?define("ajax",[],function(){return c}):window&&(window.ajax=c)})();